<!DOCTYPE html>
<html>
<head>
    <title>Loading...</title>
</head>
<body>
    <script>
        function launch() {
            const win = window.open('about:blank', '_blank');
            if (!win) {
                alert("Pop-up blocked! Please allow pop-ups to continue.");
                return;
            }

            const code = `
                <!DOCTYPE html>
                <html>
                <head>
                    <title>Nexus-Revived</title>
                    <style>
                        body, html { 
                            margin: 0; padding: 0; height: 100%; width: 100%; 
                            overflow: hidden; background-color: #000; font-family: sans-serif; 
                        }
                        #overlay {
                            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
                            background: #000; display: flex;
                            justify-content: center; align-items: center; cursor: pointer;
                            z-index: 10;
                        }
                        #overlay h1 {
                            color: white; border: 2px solid white; padding: 20px 40px;
                            border-radius: 10px; transition: 0.3s;
                        }
                        #overlay h1:hover { background: white; color: black; }
                        iframe { width: 100%; height: 100vh; border: none; display: none; }
                    </style>
                </head>
                <body>
                    <div id="overlay"><h1>CLICK TO START</h1></div>
                    <iframe id="frame" src="https://nexus-revived.onrender.com"></iframe>

                    <script>
                        const overlay = document.getElementById('overlay');
                        const frame = document.getElementById('frame');

                        // 1. Listen for Title & Favicon messages from the hosted site
                        window.addEventListener('message', function(event) {
                            // Ensure this matches the URL in your iframe src
                            if (event.origin !== "https://nexus-revived.onrender.com") return;

                            // Update Title dynamically
                            if (event.data.title) {
                                document.title = event.data.title;
                            }
                            
                            // Update Favicon dynamically
                            if (event.data.favicon) {
                                let favicon = document.getElementById('favicon');
                                if (!favicon) {
                                    favicon = document.createElement('link');
                                    favicon.id = 'favicon';
                                    favicon.rel = 'icon';
                                    document.head.appendChild(favicon);
                                }
                                favicon.href = event.data.favicon;
                            }
                        });

                        // 2. This click satisfies the "User Activation" requirement
                        overlay.addEventListener('click', function() {
                            overlay.style.display = 'none';
                            frame.style.display = 'block';
                            
                            // Now that they've clicked, we can arm the exit prompt
                            window.addEventListener('beforeunload', function (e) {
                                e.preventDefault();
                                e.returnValue = ''; // Required for Chrome/Edge/Firefox
                            });
                        });
                    <\/script>
                </body>
                </html>
            `;

            win.document.open();
            win.document.write(code);
            win.document.close();
            
            // Redirect the original launcher tab to Google
            window.location.href = "https://www.google.com";
        }

        // Instantly launch as soon as the script is read
        launch();
    </script>
</body>
</html>
